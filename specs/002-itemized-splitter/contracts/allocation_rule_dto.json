{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://expense-tracker.app/schemas/allocation_rule_dto.json",
  "title": "AllocationRule Firestore DTO",
  "description": "Configuration for how extras are allocated and rounded",
  "type": "object",
  "required": ["rounding"],
  "properties": {
    "rounding": {
      "type": "object",
      "description": "Rounding configuration",
      "required": ["precision", "mode", "distributeRemainderTo"],
      "properties": {
        "precision": {
          "type": "integer",
          "description": "Number of decimal places to round to (derived from currency)",
          "minimum": 0,
          "maximum": 4,
          "examples": [2, 0, 3]
        },
        "mode": {
          "type": "string",
          "description": "Rounding algorithm",
          "enum": ["roundHalfUp", "roundHalfEven", "floor", "ceil"],
          "default": "roundHalfUp",
          "examples": ["roundHalfUp", "roundHalfEven"]
        },
        "distributeRemainderTo": {
          "type": "string",
          "description": "Strategy for distributing rounding remainder",
          "enum": ["largestShare", "payer", "firstListed", "random"],
          "default": "largestShare",
          "examples": ["largestShare", "payer", "random"]
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "rounding": {
        "precision": 2,
        "mode": "roundHalfUp",
        "distributeRemainderTo": "largestShare"
      }
    },
    {
      "rounding": {
        "precision": 0,
        "mode": "roundHalfUp",
        "distributeRemainderTo": "payer"
      }
    },
    {
      "rounding": {
        "precision": 2,
        "mode": "roundHalfEven",
        "distributeRemainderTo": "random"
      }
    }
  ]
}
